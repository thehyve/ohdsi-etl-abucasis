DROP SCHEMA source_vocab CASCADE
;

CREATE SCHEMA source_vocab
;

SELECT
  coalesce(v.column1, cod_diagnostico) as cod_diagnostico,
  des_diagnostico,
  v.column2 as frequency
INTO source_vocab.cie9_with_frequency
FROM (VALUES
  ('401.9', 24306),
  ('250.00', 12343),
  ('272.4', 10595),
  ('305.1', 8764),
  ('427.31', 6726),
  ('V27.0', 6177),
  ('00084', 5120),
  ('460', 4566),
  ('272.0', 4414),
  ('V15.82', 4301),
  ('366.9', 4022),
  ('V58.61', 3556),
  ('599.0', 3430),
  ('278.00', 3279),
  ('462', 3181),
  ('244.9', 3079),
  ('I10', 2996),
  ('724.2', 2966),
  ('519.8', 2728),
  ('536.8', 2683),
  ('285.9', 2628),
  ('585.9', 2538),
  ('V14.0', 2370),
  ('428.0', 2364),
  ('311', 2346),
  ('V64.3', 2274),
  ('300.00', 2174),
  ('459.81', 2173),
  ('00046', 2162),
  ('466.0', 2095),
  ('584.9', 2087),
  ('518.81', 2072),
  ('V58.67', 2036),
  ('403.90', 2003),
  ('553.3', 1932),
  ('496', 1864),
  ('486', 1787),
  ('414.9', 1785),
  ('723.1', 1674),
  ('414.01', 1665),
  ('790.6', 1634),
  ('733.00', 1597),
  ('645.11', 1589),
  ('280.9', 1588),
  ('780.4', 1581),
  ('E78.5', 1581),
  ('600.00', 1576),
  ('414.8', 1561),
  ('412', 1549),
  ('V58.66', 1535),
  ('E11.9', 1496),
  ('00082', 1468),
  ('574.20', 1457),
  ('0008N', 1418),
  ('300.4', 1399),
  ('491.21', 1369),
  ('719.46', 1363),
  ('V58.63', 1354),
  ('V45.82', 1348),
  ('401.1', 1341),
  ('V14.8', 1339),
  ('692.9', 1282),
  ('V14.6', 1252),
  ('V12.54', 1251),
  ('491.20', 1239),
  ('00132', 1219),
  ('366.10', 1212),
  ('428.9', 1202),
  ('550.90', 1198),
  ('658.11', 1183),
  ('401', 1183),
  ('V45.01', 1168),
  ('300.0', 1158),
  ('272.9', 1118),
  ('784.0', 1097),
  ('424.1', 1046),
  ('V07.39D', 1034),
  ('V45.61', 1030),
  ('780.52', 1028),
  ('V46.2', 1013),
  ('V43.1', 988),
  ('331.0', 987),
  ('009.1', 968),
  ('493.90', 966),
  ('715.90', 946),
  ('562.10', 937),
  ('520.6', 928),
  ('659.61', 914),
  ('719.41', 909),
  ('424.0', 907),
  ('V66.7', 872),
  ('372.0', 865),
  ('354.0', 859),
  ('511.9', 848),
  ('V43.65', 845),
  ('724.5', 813),
  ('303.91', 810),
  ('162.9', 795),
  ('F17.210', 793),
  ('518.84', 777),
  ('463', 773),
  ('650', 772),
  ('789.0', 764),
  ('380.4', 760),
  ('786.2', 759),
  ('V12.59', 756),
  ('428.1', 730),
  ('188.9', 728),
  ('715', 715),
  ('V43.64', 708),
  ('332.0', 707),
  ('272', 703),
  ('525.9', 700),
  ('197.7', 698),
  ('382.9', 696),
  ('00004', 685),
  ('724.3', 684),
  ('V10.3', 679),
  ('564.0', 678),
  ('327.23', 670),
  ('V14.1', 663),
  ('706.2', 654),
  ('595', 634),
  ('729.5', 625),
  ('402.90', 618),
  ('522.7', 608),
  ('Z87.891', 601),
  ('434.91', 594),
  ('786.09', 594),
  ('735.0', 591),
  ('V45.77', 585),
  ('787.91', 584),
  ('V45.79', 564),
  ('278.01', 557),
  ('715.36', 552),
  ('426.4', 551),
  ('787.1', 551),
  ('V46.8', 548),
  ('726.90', 548),
  ('995.3', 541),
  ('416.8', 525),
  ('788.3', 524),
  ('595.0', 523),
  ('V60.6', 520),
  ('455.6', 515),
  ('530.81', 506),
  ('110.1', 505),
  ('411.1', 500),
  ('V45.81', 499),
  ('278.02', 489),
  ('V88.01', 488),
  ('174.9', 486),
  ('719.45', 485),
  ('715.09', 483),
  ('585.3', 477),
  ('Z79.01', 476),
  ('577.0', 474),
  ('V43.3', 474),
  ('780.2', 470),
  ('558.9', 469),
  ('595.9', 469),
  ('682.9', 468),
  ('185', 459),
  ('345.90', 457),
  ('477.9', 454),
  ('788.0', 451),
  ('715.9', 448),
  ('070.54', 437),
  ('216.9', 433),
  ('786.50', 432),
  ('820.20', 424),
  ('621.0', 422),
  ('564.00', 417),
  ('101010', 412),
  ('365.9', 410),
  ('V72.31', 410),
  ('Z37.0', 408),
  ('477', 408),
  ('V25.2', 407),
  ('410.71', 405),
  ('425.4', 405),
  ('366.16', 400),
  ('632', 398),
  ('198.5', 398),
  ('709.9', 397),
  ('472.0', 396),
  ('078.10', 396),
  ('V02.51', 394),
  ('585.6', 392),
  ('708.9', 387),
  ('413.9', 384),
  ('197.0', 377),
  ('790.4', 375),
  ('627.2', 373),
  ('592.0', 367),
  ('648.91', 367),
  ('553.1', 365),
  ('780.57', 364),
  ('820.09', 358),
  ('789.06', 357),
  ('041.4', 353),
  ('540.9', 351),
  ('H26.9', 347),
  ('389.9', 343),
  ('507.0', 343),
  ('654.21', 339),
  ('V47.4', 322),
  ('366.19', 313),
  ('403.91', 313),
  ('780.79', 312),
  ('V58.11', 310),
  ('592.1', 298),
  ('490', 291),
  ('038.9', 289),
  ('780', 289),
  ('V87.41', 284),
  ('218.9', 280),
  ('518.82', 277),
  ('571.5', 275),
  ('99.21', 273),
  ('431', 273),
  ('600.90', 273),
  ('V26.81', 271),
  ('845.00', 271),
  ('415.19', 261),
  ('13.41', 260),
  ('487', 257),
  ('566', 254),
  ('V15.3', 245),
  ('481', 245),
  ('553.21', 242),
  ('454.9', 241),
  ('13.71', 239),
  ('99.29', 232),
  ('562.11', 231),
  ('664.01', 228),
  ('565.1', 228),
  ('590.10', 227),
  ('574.00', 225),
  ('786.51', 225),
  ('V22.2', 225),
  ('112.1', 224),
  ('E03.9', 224),
  ('87.44', 223),
  ('669.51', 221),
  ('470', 221),
  ('V54.01', 220),
  ('250', 219),
  ('272.2', 217),
  ('435.9', 217),
  ('780.6', 217),
  ('079.99', 217),
  ('214.1', 213),
  ('715.35', 212),
  ('272.1', 207),
  ('197.6', 207),
  ('443.9', 206),
  ('380.1', 206),
  ('00085', 205),
  ('571.8', 204),
  ('379.29', 204),
  ('410.41', 203),
  ('692', 202),
  ('V10.51', 201),
  ('578.9', 199),
  ('I50.9', 197),
  ('173.3', 196),
  ('88.72', 195),
  ('380.10', 195),
  ('722.10', 192),
  ('00001', 192),
  ('87.03', 191),
  ('362.16', 190),
  ('154.1', 189),
  ('644.03', 188),
  ('924.9', 188),
  ('995.92', 186),
  ('434.01', 186),
  ('685.1', 185),
  ('560.9', 185),
  ('112.0', 184),
  ('331.83', 182),
  ('790', 181),
  ('717.2', 180),
  ('88.76', 180),
  ('518.89', 179),
  ('362.52', 179),
  ('575.0', 178),
  ('H25.9', 176),
  ('366.18', 176),
  ('153.3', 173),
  ('250.80', 173),
  ('525.3', 173),
  ('V12.51', 172),
  ('410.11', 170),
  ('729.1', 169),
  ('362.50', 168),
  ('426.0', 168),
  ('V58.69', 167),
  ('733.90', 167),
  ('491.22', 167),
  ('V24.1', 166),
  ('574.10', 166),
  ('998.59', 166),
  ('715.96', 165),
  ('995.91', 164),
  ('73.59', 163),
  ('733.0', 161),
  ('88.01', 160),
  ('285.1', 152),
  ('Z79.82', 150),
  ('E66.9', 139),
  ('571.2', 138),
  ('593.2', 137),
  ('414.00', 132),
  ('V49.84', 130),
  ('726.70', 129),
  ('W19.XXXA', 121),
  ('042', 116),
  ('362.01', 114),
  ('V12.01', 113),
  ('785.52', 113),
  ('628.8', 112),
  ('735.5', 111),
  ('656.11', 105),
  ('518.83', 101),
  ('V02.62', 98),
  ('V49.87', 96),
  ('600.20', 96),
  ('664.11', 93),
  ('714.0', 88),
  ('Z79.4', 87),
  ('290.0', 84),
  ('648.22', 82),
  ('Z86.73', 77),
  ('788.30', 74),
  ('V10.05', 71),
  ('429.3', 67),
  ('782.3', 65),
  ('Z51.5', 51),
  ('281.9', 50),
  ('426.3', 47),
  ('535.10', 42),
  ('V60.3', 41),
  ('V45.89', 39),
  ('707.20', 36),
  ('285.29', 32),
  ('N18.9', 32),
  ('041.04', 31),
  ('303.93', 31),
  ('276.2', 31),
  ('Z79.02', 31),
  ('Z99.81', 30),
  ('V49.86', 28),
  ('V49.89', 28),
  ('V45.73', 28),
  ('N40.0', 26),
  ('707.03', 23),
  ('293.0', 22),
  ('Z95.5', 21),
  ('780.60', 19),
  ('041.49', 19),
  ('V13.02', 17),
  ('787.60', 17),
  ('285.21', 14),
  ('Z59.3', 14),
  ('V15.29', 12),
  ('V45.02', 12),
  ('041.7', 11),
  ('583.81', 11),
  ('Z88.0', 10),
  ('V45.72', 10),
  ('V15.51', 10),
  ('J44.9', 10),
  ('276.7', 8),
  ('Z74.01', 7),
  ('438.20', 6),
  ('V09.1', 6),
  ('V07.0', 6),
  ('V61.49', 6),
  ('V15.08', 6),
  ('427.89', 6),
  ('357.2', 6),
  ('041.19', 6),
  ('K44.9', 6),
  ('573.8', 6),
  ('305.01', 6),
  ('440.0', 5),
  ('V85.1', 5),
  ('V69.0', 5),
  ('Z95.0', 5),
  ('263.9', 5),
  ('787.20', 5),
  ('276.8', 5),
  ('V15.88', 5),
  ('041.85', 5),
  ('211.3', 5),
  ('Z92.3', 5)) v
  FULL OUTER JOIN tba_cie9 ON v.column1 = cod_diagnostico
;

SELECT
  coalesce(v.column1, cod_procedimiento) as cod_procedimiento,
  des_procedimiento,
  v.column2 as frequency
INTO source_vocab.cie9p_with_frequency
FROM (VALUES
  ('13.41', 6053),
  ('13.71', 5752),
  ('99.21', 5721),
  ('99.29', 5335),
  ('87.44', 4613),
  ('88.72', 4395),
  ('87.03', 3860),
  ('73.59', 3637),
  ('88.76', 3594),
  ('38.93', 3127),
  ('89.52', 3006),
  ('88.01', 2861),
  ('39.96', 2844),
  ('87.41', 2564),
  ('99.04', 2395),
  ('99.18', 2284),
  ('75.34', 2235),
  ('99.19', 2199),
  ('3.91', 1972),
  ('88.78', 1933),
  ('89.65', 1787),
  ('86.3', 1708),
  ('88.91', 1470),
  ('73.6', 1467),
  ('93.96', 1404),
  ('74.1', 1213),
  ('23.19', 1156),
  ('99.23', 1148),
  ('88.38', 1062),
  ('3E03329', 956),
  ('73.4', 894),
  ('44.13', 874),
  ('0.66', 865),
  ('93.94', 854),
  ('53.05', 811),
  ('14.79', 808),
  ('51.23', 802),
  ('88.79', 798),
  ('75.69', 797),
  ('57.49', 794),
  ('37.22', 788),
  ('0.40', 783),
  ('81.54', 779),
  ('45.23', 774),
  ('75.33', 745),
  ('88.57', 732),
  ('88.75', 724),
  ('88.19', 706),
  ('93.90', 669),
  ('4.43', 656),
  ('88.56', 655),
  ('80.26', 633),
  ('57.94', 629),
  ('89.66', 590),
  ('0.45', 581),
  ('88.77', 573),
  ('88.97', 570),
  ('88.71', 569),
  ('89.37', 564),
  ('72.71', 562),
  ('3E033GC', 559),
  ('96.04', 551),
  ('99.25', 524),
  ('73.09', 521),
  ('90.59', 518),
  ('36.07', 509),
  ('3E033NZ', 502),
  ('B246ZZZ', 474),
  ('81.51', 444),
  ('4A02X4Z', 441),
  ('69.02', 431),
  ('99.17', 430),
  ('12.92', 429),
  ('85.21', 425),
  ('80.6', 412),
  ('99.11', 399),
  ('37.21', 393),
  ('38.59', 384),
  ('68.29', 384),
  ('39.95', 376),
  ('BW03ZZZ', 370),
  ('3E0337Z', 366),
  ('91.32', 361),
  ('99.15', 359),
  ('59.8', 358),
  ('86.22', 352),
  ('36.06', 347),
  ('08RJ3JZ', 345),
  ('10E0XZZ', 343),
  ('68.12', 338),
  ('79.35', 337),
  ('65.91', 334),
  ('88.41', 331),
  ('79.15', 326),
  ('14.75', 320),
  ('BW40ZZZ', 316),
  ('88.02', 307),
  ('3E0C3GC', 301),
  ('08RK3JZ', 300),
  ('63.73', 300),
  ('68.49', 299),
  ('88.93', 298),
  ('79.36', 296),
  ('90.52', 292),
  ('30.09', 282),
  ('81.52', 281),
  ('53.41', 276),
  ('49.46', 269),
  ('54.91', 264),
  ('68.11', 259),
  ('45.25', 258),
  ('37.83', 257),
  ('14.74', 254),
  ('77.54', 254),
  ('89.17', 251),
  ('39.97', 249),
  ('89.54', 249),
  ('88.73', 249),
  ('34.91', 247),
  ('60.29', 241),
  ('39.61', 239),
  ('53.61', 237),
  ('49.01', 236),
  ('47.09', 233),
  ('37.72', 229),
  ('96.70', 222),
  ('89.14', 221),
  ('96.71', 219),
  ('60.11', 216),
  ('99.05', 213),
  ('89.50', 212),
  ('98.51', 206),
  ('99.24', 205),
  ('86.4', 204),
  ('86.21', 197),
  ('0.46', 194),
  ('88.26', 193),
  ('51.22', 192),
  ('65.61', 188),
  ('47.01', 185),
  ('53.04', 183),
  ('77.51', 181),
  ('79.32', 178),
  ('68.59', 177),
  ('88.53', 176),
  ('4A12X45', 176),
  ('33.24', 174),
  ('50.11', 173),
  ('53.00', 172),
  ('6.4', 169),
  ('B020ZZZ', 168),
  ('54.21', 167),
  ('34.04', 163),
  ('85.22', 156),
  ('30233N1', 156),
  ('99.07', 154),
  ('79.31', 151),
  ('88.74', 151),
  ('81.83', 147),
  ('3E0333Z', 146),
  ('40.11', 145),
  ('81.62', 144),
  ('0FT44ZZ', 143),
  ('72.8', 138),
  ('21.88', 137),
  ('88.48', 137),
  ('44.14', 131),
  ('80.21', 130),
  ('81.92', 130),
  ('57.32', 129),
  ('10D00Z1', 129),
  ('39.27', 128),
  ('45.13', 125),
  ('51.10', 123),
  ('53.03', 123),
  ('86.07', 123),
  ('23.11', 122),
  ('64.0', 120),
  ('74.0', 120),
  ('91.39', 119),
  ('53.49', 119),
  ('69.99', 118),
  ('45.73', 118),
  ('74.99', 118),
  ('12.64', 117),
  ('0.41', 114),
  ('67.2', 114),
  ('6.2', 114),
  ('89.59', 113),
  ('60.5', 112),
  ('80.51', 112),
  ('84.51', 107),
  ('88.39', 106),
  ('91.33', 103),
  ('89.41', 103),
  ('70.51', 103),
  ('40.23', 101),
  ('87.79', 95),
  ('3E033VJ', 94),
  ('3.31', 94),
  ('87.62', 93),
  ('76.39', 89),
  ('88.43', 89),
  ('BY4FZZZ', 76),
  ('96.6', 75),
  ('88.27', 72),
  ('90.53', 71),
  ('87.49', 70),
  ('0W8NXZZ', 67),
  ('38.91', 60),
  ('3E0R3CZ', 60),
  ('51.85', 60),
  ('37.26', 60),
  ('96.07', 58),
  ('99.10', 53),
  ('99.26', 40),
  ('10903Z9', 37),
  ('3E0F7GC', 35),
  ('05HY33Z', 35),
  ('4A0HXCZ', 31),
  ('94.19', 30),
  ('96.72', 28),
  ('4A1HXCZ', 26),
  ('94.52', 23),
  ('94.23', 23),
  ('90.43', 22),
  ('37.23', 22),
  ('88.47', 22),
  ('3E0F7SF', 18),
  ('89.13', 17),
  ('96.49', 16),
  ('96.39', 15),
  ('4A033R1', 14),
  ('89.38', 14),
  ('86.28', 13),
  ('0.47', 13),
  ('99.20', 9),
  ('3E013GC', 9),
  ('41.31', 9),
  ('90.92', 7),
  ('88.92', 7),
  ('89.04', 6),
  ('93.99', 6),
  ('31.1', 6),
  ('97.65', 5)) v
  FULL OUTER JOIN tba_cie9p ON v.column1 = cod_procedimiento
;